/** * Created by pjw on 2015-01-07. * version: 1.0.0-2015.1.8 * *基于一下插件实现 *jquery-1.10.1.min.js *jquery.form.js *artDialog/css/ui-dialog.css *artDialog/dist/dialog.js *///$('head').append('<script type="text/javascript" src="http://www.315jinhuo.com/Public/Admin/jquery.form.js"></script>'); //$('head').append('<link type="text/css" rel="stylesheet" href="http://www.315jinhuo.com/Public/Admin/artDialog/css/ui-dialog.css" />');//$('head').append('<script type="text/javascript" src="http://www.315jinhuo.com/Public/Admin/artDialog/dist/dialog.js"></script>'); var Ruiec=function(){};Ruiec = {    /**     * 基于弹窗组件的弹窗     * @param _text     */    alert: function (_text) {        var d = dialog({            title: layer_friendly_tips,            content: _text,            fixed: true,            cancel: true,            cancelValue: layer_close        });        d.show();    },    /**     * 确定取消 更多运用于 删除     * @param _obj     * @param opt     */    confirm:function(_obj,opt){        option={            text:opt.text,            okValue:layer_confirm,            ok:function(){                return true;            },            cancelValue:layer_cancel,            cncale:true,            title:layer_friendly_tips        };        if(opt){            if(opt.text){                option.text=opt.text;            }            if(opt.okValue){                option.okValue=opt.okValue;            }            if(opt.ok){                option.ok=opt.ok;            }            if(opt.cancelValue){                option.cancelValue=opt.cancelValue;            }            if(opt.cncale){                option.cncale=opt.cncale;            }            if(opt.title){                option.title=opt.title;            }            if(opt.url){                option.ok=function(){                    $.ajax({                        "url":opt.url,                        "type":"post",                        "dataType":"json",                        success:function (data, textStatus) {                            if (data.status == 0) {                                Ruiec.alert(data.info);                            } else {                                if (data.url != '') {                                    Ruiec.alert(data.info);                                    setTimeout(function(){                                        window.location.href ='http://'+window.location.host+data.url                                    },1000);                                } else {                                    Ruiec.alert(data.info);                                }                            }                        }                    });                }            }        }        var d = dialog({            title: option.title,            content: opt.text,            fixed: true,            cancel: option.cncale,            cancelValue: option.cancelValue,            okValue:option.okValue,            ok:option.ok        });        d.show();    },    /**     * AjaxSubmit快速提交     * @param _obj     * @param opt AJAX数据     */    submit: function (_obj, opt) {        option = {            /**             * 成功             * @param data             */            success: function (data, textStatus) {                if (data.status == 0) {                    alert(data.info);                    //Ruiec.alert(data.info);                } else {                    if (data.url != '') {                        if(data.info==''){                            location.href = data.url                        }else{                            alert(data.info);                            /*if(data.url){                                setTimeout(function(){ location.href = data.url },1000);                            }*/                        }                    } else {                        alert(data.info);                    }                }            },            url:''        }        //获取FORM        var _form =$(_obj).parents('form').eq(0);        //判断AJAX参数是否存在        if (opt) {            //判断success是否存在，存在，重写success            if (opt.success) {                option.success = opt.success;            }            if (opt.url) {                option.success = opt.url;            }            if(opt.id){                _form=$('#'+opt.id);            }        }        _form.ajaxSubmit({            success: option.success        });    },    /**     * 省市区三级级联     * <select name="post[province]" id="province" ></select>     * <select name="post[city]" id="city" ></select>     * <select name="post[area]" id="area" ></select>     * @param opt     */    address:function(opt){        $('head').append('<script type="text/javascript" src="http://www.315jinhuo.com/Public/Admin/address/area.js"></script>');        $('head').append('<script type="text/javascript" src="http://www.315jinhuo.com/Public/Admin/address/location.js"></script>');        option={            province:'',            city:'',            area:''        }        if(opt){            if(opt.province){                option.province=opt.province;            }            if(opt.city){                option.city=opt.city;            }            if(opt.area){                option.area=opt.area            }        }        addressInit('province', 'city', 'area', option.province, option.city, option.city);    },    tab:function(_obj,opt){        option={            ThisClass:'this_class',            CurrClass:'curr',            ThatId:'ruiec_tab',            ThatClass:'that_class'        }        if(opt){            if(opt.ThisClass){                option.ThisClass=opt.ThisClass;            }            if(opt.CurrClass){                option.CurrClass=opt.CurrClass;            }            if(opt.ThatId){                option.ThatId=opt.ThatId;            }            if(opt.ThatClass){                option.ThatClass=opt.ThatClass;            }        }        var _index=$(_obj).index();        console.log();    },    check: {        //判断不能为空        nulls:function(opt){            option={                align:'right',                content:layer_not_null,                string:''            }            if(opt){                if(opt.content){                    option.content=opt.content;                }                if(opt.id){                    option.id=opt.id;                }                if(opt.string){                    option.string=opt.string;                }            }            if($('#'+option.id).val() ==option.string || $('#'+option.id).val()==null){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.id)).focus();                $('#'+option.id).focus();                return false;            }else{                return true;            }        },        //字符串的长度        length:function(opt){            option={                align:'right',                length:20,                content:layer_least+option.length+layer_max_characters            }            if(opt){                if(opt.id){                    option.id=opt.id;                }                if(opt.length){                    option.length=opt.length;                    option.content=layer_least+option.length+layer_max_characters                }                if(opt.content){                    option.content=opt.content;                }            }            if($('#'+option.id).val().length <option.length){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.id));                $('#'+option.id).focus();                return false;            }else{                return true;            }        },        //密码重复的判断        check:function(opt){            option={                align:'right',                content:layer_error_repeat_pwd            }            if(opt){                if(opt.content){                    option.content=opt.content;                }                if(opt.id){                    option.id=opt.id;                }                if(opt.rid){                    option.rid=opt.rid;                }            }            if ($('#'+option.id).val() != $('#'+option.rid).val()){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.rid)).focus();                $('#'+option.rid).focus();                return false;            }else{                return true;            }        },        //Email的判断        email:function(opt){            option={                align:'right',                content:layer_email_error            }            if(opt){                if(opt.content){                    option.content=opt.content;                }                if(opt.id){                    option.id=opt.id;                }            }            var rule = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;            if (!rule.test($('#'+option.id).val())){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.id)).focus();                $('#'+option.id).focus();                return false;            }else{                return true;            }        },        //只允许填写字母和数组        float_and_number:function(opt) {            option={                align:'right',                content:layer_number_letters            }            if(opt){                if(opt.content){                    option.content=opt.content;                }                if(opt.id){                    option.id=opt.id;                }            }            var rule = /^[A-Za-z0-9]+$/;            if (!rule.test($('#'+option.id).val())){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.id)).focus();                $('#'+option.id).focus();                return false;            }else{                return true;            }        },        number:function(opt){            option={                align:'right',                content:layer_format_error            }            if(opt){                if(opt.content){                    option.content=opt.content;                }                if(opt.id){                    option.id=opt.id;                }            }            var rule = /^[0-9]+$/;            if (!rule.test($('#'+option.id).val())){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.id)).focus();                $('#'+option.id).focus();                return false;            }else{                return true;            }        },        mobile:function(opt){            option={                align:'right',                content:layer_mobile_error            }            if(opt){                if(opt.content){                    option.content=opt.content;                }                if(opt.id){                    option.id=opt.id;                }            }            var rule = /^1\d{10}$/;            if (!rule.test($('#'+option.id).val())){                //$('#'+option.id).css('border','1px solid red');                var d = dialog({                    align: 'right',                    content: option.content,                    quickClose: true,                    autofocus: true                });                d.show(document.getElementById(option.id)).focus();                $('#'+option.id).focus();                return false;            }else{                return true;            }        }    },    down:{        option:{        },        /**         * JSON 数据         */        data:{        },        /**         *         * @param obj   this         * @param id    '#s'         * @param pid         * @constructor         */        AddSelect:function(id,obj,pid){            $(obj).nextAll().remove();                          //移除后面的元素            var thelength   =$(id+' select').size();          //现在已经存在多少个下拉框了            var thepid      =pid?pid:0;                         //下拉框内容的PID            var level       =0;            for(var a in Ruiec.down.option)            {                level++;            }            //如果当前的select数量小于层级数            if(thelength<level){                var c   =0;                var html='<select size="'+Ruiec.down.option[thelength]['size']+'" class="sel" name="'+Ruiec.down.option[thelength]['name']+'"><option>'+layer_please_select+'</option>';                $(Ruiec.down.data).each(function(){                    if(this.pid==thepid){                        c++;                        html    +='<option value="'+this.id+'">'+this.name+'</option>';                    }                });                html    +='</select>';                if(c!=0){                    $(id).append(html);                }            }        },        /**         *         * @param id        '#s'         * @param pid         * @param level     一共多少级         * @constructor         */        InitSelect:function(id,pid){            var level       =0;            for(var a in Ruiec.down.option)            {                level++;            }            for(var i=0;i<level;i++){                var thelength=$(id+' select').size();                var thepid=pid;                if(thelength!=0){                    thepid=$("select[name='"+Ruiec.down.option[thelength-1]['name']+"']").val();                }                var html='<select size="'+Ruiec.down.option[thelength]['size']+'" class="sel" name="'+Ruiec.down.option[thelength]['name']+'"><option>'+layer_please_select+'</option>';                $(Ruiec.down.data).each(function(){                    if(this.pid==thepid){                        var select="";                        if(Ruiec.down.option[thelength]['value']==this.id){                            select="selected";                        }                        html    +='<option '+select+' index="'+thelength+'" value="'+this.id+'">'+this.name+'</option>';                    }                });                html    +='</select>';                $(id).append(html);            }        }    }}